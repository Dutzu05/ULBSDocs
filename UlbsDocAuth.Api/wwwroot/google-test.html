<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Google ID Token Test</title>

    <!-- Google Identity SDK -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
  </head>

  <body>
    <h1>Google ID Token Test</h1>

    <div id="g_id_button"></div>

    <p><strong>ID Token</strong></p>
    <textarea id="id_token" rows="10" cols="120" readonly></textarea>
    <div>
      <button id="copy_token" type="button">Copy token</button>
    </div>

    <script>
      window.onload = () => {
        google.accounts.id.initialize({
          // Must match GoogleAuth:ClientId in appsettings.Development.json
          client_id: "428144697724-tguuae6k2abj8115ap1phrgcmig37qtf.apps.googleusercontent.com",
          callback: (response) => {
            const token = response.credential;
            console.log("ID TOKEN:", token);
            document.getElementById("id_token").value = token || "";
          }
        });

        google.accounts.id.renderButton(
          document.getElementById("g_id_button"),
          { theme: "outline", size: "large" }
        );

        google.accounts.id.prompt();
      };

      document.getElementById("copy_token").addEventListener("click", async () => {
        const token = document.getElementById("id_token").value;
        if (!token) return;
        try {
          await navigator.clipboard.writeText(token);
        } catch {
          // Fallback: select so user can copy manually.
          const textarea = document.getElementById("id_token");
          textarea.focus();
          textarea.select();
        }
      });
    </script>
  </body>
</html>
